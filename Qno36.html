<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cookie Management</title>
    <style>
      table {
        border-collapse: collapse;
        margin-top: 10px;
      }
      table,
      th,
      td {
        border: 1px solid black;
      }
      th,
      td {
        padding: 5px;
        text-align: left;
      }
      #output {
        margin-top: 10px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>Cookie Management</h2>
    <form id="cookieForm" onsubmit="return false;">
      <label for="key">Key:</label>
      <input type="text" id="key" required /><br /><br />
      <label for="value">Value:</label>
      <input type="text" id="value" /><br /><br />
      <button type="button" onclick="setCookie()">Set Cookie</button>
      <button type="button" onclick="getCookie()">Get Cookie</button>
      <button type="button" onclick="deleteCookie()">Delete Cookie</button>
      <button type="button" onclick="deleteAllCookies()">
        Delete All Cookies
      </button>
    </form>
    <br />
    <button onclick="displayCookies()">Display All Cookies</button>
    <div id="cookieTable"></div>
    <p id="output"></p>

    <script>
      // a. To accept Key and Values from user and store into a cookie
      function setCookie() {
        const key = document.getElementById("key").value;
        const value = document.getElementById("value").value;
        const expiryDays = 7; // Default expiry in days (optional)
        console.log(key, value);
        if (!key || !value) {
          document.getElementById("output").textContent =
            "Key and Value are required to set a cookie.";
          return;
        }

        document.cookie = `${encodeURIComponent(key)}=${encodeURIComponent(
          value
        )}`;
        document.getElementById(
          "output"
        ).textContent = `Cookie set: ${key}=${value} (expires in ${expiryDays} days)`;
        console.log(document.cookie);
      }

      // b. To read a cookie according to key entered by the user
      function getCookie() {
        const key = document.getElementById("key").value.trim();

        if (!key) {
          document.getElementById("output").textContent =
            "Key is required to fetch a cookie.";
          return;
        }

        const cookies = document.cookie
          .split(";")
          .map((cookie) => cookie.split("="));
        const found = cookies.find(([k]) => decodeURIComponent(k) === key);
        const value = found ? decodeURIComponent(found[1]) : "Not found";

        document.getElementById("output").textContent = found
          ? `Cookie value: ${value}`
          : `Cookie with key "${key}" not found.`;
      }

      // c. To display all cookies into tabular format as key : value
      function displayCookies() {
        const cookies = document.cookie
          ? document.cookie.split("; ").map((cookie) => cookie.split("="))
          : [];

        if (cookies.length === 0) {
          document.getElementById("cookieTable").innerHTML =
            "<p>No cookies available.</p>";
          return;
        }

        let tableHTML = "<table><tr><th>Key</th><th>Value</th></tr>";
        cookies.forEach(([key, value]) => {
          tableHTML += `<tr><td>${decodeURIComponent(
            key
          )}</td><td>${decodeURIComponent(value)}</td></tr>`;
        });
        tableHTML += "</table>";
        document.getElementById("cookieTable").innerHTML = tableHTML;
      }

      // d. To delete a cookie according to the key entered by the user
      function deleteCookie() {
        const key = document.getElementById("key").value.trim();

        if (!key) {
          document.getElementById("output").textContent =
            "Key is required to delete a cookie.";
          return;
        }

        document.cookie = `${encodeURIComponent(
          key
        )}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
        document.getElementById(
          "output"
        ).textContent = `Cookie deleted: ${key}`;
      }

      // e. To delete all cookies
      function deleteAllCookies() {
        const cookies = document.cookie
          ? document.cookie.split("; ").map((cookie) => cookie.split("=")[0])
          : [];

        if (cookies.length === 0) {
          document.getElementById("output").textContent =
            "No cookies to delete.";
          return;
        }

        cookies.forEach((key) => {
          document.cookie = `${key}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
        });

        document.getElementById("output").textContent = "All cookies deleted.";
        document.getElementById("cookieTable").innerHTML = "";
      }
    </script>
  </body>
</html>
